suite: Test gitops namespace with various configurations
templates:
  - templates/plumbing/gitops-namespace.yaml
release:
  name: release-test
tests:
  - it: should create gitops namespace with default values
    set:
      global:
        pattern: test-pattern
      clusterGroup:
        name: hub
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: Namespace
      - equal:
          path: metadata.name
          value: test-pattern-hub
      - equal:
          path: metadata.labels.name
          value: test-pattern-hub

  - it: should create gitops namespace with custom pattern and cluster group
    set:
      global:
        pattern: my-custom-pattern
      clusterGroup:
        name: edge-cluster
    asserts:
      - hasDocuments:
          count: 1
      - equal:
          path: metadata.name
          value: my-custom-pattern-edge-cluster
      - equal:
          path: metadata.labels.name
          value: my-custom-pattern-edge-cluster

  - it: should handle special characters in pattern name
    set:
      global:
        pattern: multi-word-pattern
      clusterGroup:
        name: production-cluster
    asserts:
      - hasDocuments:
          count: 1
      - equal:
          path: metadata.name
          value: multi-word-pattern-production-cluster
      - equal:
          path: metadata.labels.name
          value: multi-word-pattern-production-cluster

  - it: should create namespace with minimal configuration
    set:
      global:
        pattern: minimal
      clusterGroup:
        name: test
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: Namespace
      - equal:
          path: metadata.name
          value: minimal-test
      - equal:
          path: spec
          value: {}
